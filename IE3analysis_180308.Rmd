---
title: "Implicit Encoding with 3 Speeded Naming Tasks"
author: "Jessica Nicosia"
date: "Updated 3/5/18"
output:
  pdf_document:
    toc: yes
    toc_depth: 6
  html_document:
    toc: yes
    toc_depth: 6
    toc_float: yes
  word_document:
    toc: yes
    toc_depth: '6'
---

```{r setup, include = FALSE}
rm(list = ls(all = TRUE)) 
knitr::opts_chunk$set(echo = FALSE, collapse = TRUE, fig.show = 'hold')
```

```{r, include = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
# load packages
suppressMessages(library(plyr))
suppressMessages(library(dplyr))
suppressMessages(library(tidyr))
suppressMessages(library(ggplot2))
suppressMessages(library(Rmisc))
suppressMessages(library(psych))
suppressMessages(library(ggthemes))
suppressMessages(library(knitr))
suppressMessages(library(pander))
suppressMessages(library(car))
suppressMessages(library(ez))
suppressMessages(library(sjPlot))
```

\newpage
# Implicit Encoding
```{r}
#IE SPEEDED NAMING 1
# set working directory
wd <- "/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/data/3SNdata/sn1/"
setwd("~/")
setwd("/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/data/3SNdata/sn1/")

# read in all data files
N <- paste(wd, list.files(wd), sep = "")

# make data frame
data <- data.frame()

# select columns of data
for (i in 1:length(N)){
  file <- N[i]
  data_in <- read.csv(file, header = TRUE, stringsAsFactors = FALSE)
  data_in <- data_in[,c("Subject", "enterResponse.RESP.Trial.", "nameItem", "freq", "studied", "Target.RT")]
  data <- rbind(data, data_in)
}

#first trim (take out any raw rts less than 200ms)
data$rt.trim <- with(data, ifelse(Target.RT >= 200, Target.RT, NA))
data$rt.trim <- with(data, ifelse(Target.RT <= 2500, Target.RT, NA))

#rename enterResponse column
data$enterResponse.RESP <- data$enterResponse.RESP.Trial.
data <- subset(data, select = c(-enterResponse.RESP.Trial.))

#denote that this is data1 
data$data_set <- "data1"

#add trial # column
data$trialNumber <- seq(from = 1, to = 40, by = 1)

#IE SPEEDED NAMING 2
# set working directory
wd <- "/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/data/3SNdata/sn2/"
setwd("~/")
setwd("/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/data/3SNdata/sn2/")

# read in all data files
N <- paste(wd, list.files(wd), sep = "")

# make data frame
data2 <- data.frame()

# select columns of data
for (i in 1:length(N)){
  file <- N[i]
  #print(file)
  data_in <- read.csv(file, header = TRUE, stringsAsFactors = FALSE)
  data_in <- data_in[,c("Subject", "enterResponse.RESP", "nameItem", "freq","studied", "Target.RT", "recog.ACC", "recog.RT")]
  data2 <- rbind(data2, data_in)
}

#add trial # column
data2$trialNumber <- seq(from = 1, to = 40, by = 1)

#first trim (take out any raw rts less than 200ms)
data2$rt.trim <- with(data2, ifelse(Target.RT >= 200, Target.RT, NA))
data2$rt.trim <- with(data2, ifelse(Target.RT <= 2500, Target.RT, NA))

data2$recog.rt.trim <- with(data2, ifelse(recog.RT >= 200, recog.RT, NA))
data2$recog.rt.trim <- with(data2, ifelse(recog.RT <= 2500, recog.RT, NA))

#rename enterResponse column
#data2$enterResponse.RESP <- data2$enterResponse.RESP.Trial.
#data2 <- subset(data2, select = c(-enterResponse.RESP.Trial.))

#denote that this is data2 
data2$data_set <- "data2"

#IE SPEEDED NAMING 1
# set working directory
wd <- "/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/data/3SNdata/sn3/"
setwd("~/")
setwd("/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/data/3SNdata/sn3/")

# read in all data files
N <- paste(wd, list.files(wd), sep = "")

# make data frame
data3 <- data.frame()

# select columns of data
for (i in 1:length(N)){
  file <- N[i]
  data_in <- read.csv(file, header = TRUE, stringsAsFactors = FALSE)
  data_in <- data_in[,c("Subject", "enterResponse.RESP.Trial.", "nameItem", "freq", "studied", "Target.RT")]
  data3 <- rbind(data3, data_in)
}

#add trial # column
data3$trialNumber <- seq(from = 1, to = 40, by = 1)

#first trim (take out any raw rts less than 200ms)
data3$rt.trim <- with(data3, ifelse(Target.RT >= 200, Target.RT, NA))
data3$rt.trim <- with(data3, ifelse(Target.RT <= 2500, Target.RT, NA))

#rename enterResponse column
data3$enterResponse.RESP <- data3$enterResponse.RESP.Trial.
data3 <- subset(data3, select = c(-enterResponse.RESP.Trial.))

#denote that this is data3 
data3$data_set <- "data3"

# ACCURACY CODING
#speeded naming 1
data <- mutate(data, enterResponse.RESP = as.character(enterResponse.RESP))
data <- mutate(data, enterResponse.RESP = sapply(strsplit(data$enterResponse.RESP, split='{', fixed =TRUE), function(x) (x[1])))
data$enterResponse.RESP <- as.character(data$enterResponse.RESP)
data$enterResponse.RESP <- sapply(data$enterResponse.RESP, toupper)
data$enterResponse.RESP <- gsub("[ ]", "", data$enterResponse.RESP)
data$nameItem <- gsub("[ ]", "", data$nameItem)
data$accuracy <- with(data, ifelse(nameItem == enterResponse.RESP, 1, 0))

#remove the 2 from the string and check if accurate
data <- mutate(data, enterResponse.RESP = sapply(strsplit(data$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data$enterResponse.RESP <- as.character(data$enterResponse.RESP)
data$enterResponse.RESP <- sapply(data$enterResponse.RESP, toupper)
data$enterResponse.RESP <- gsub("[ ]", "", data$enterResponse.RESP)
data$nameItem <- gsub("[ ]", "", data$nameItem)
data$accuracy <- with(data, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check*******************************************************************************************************************************
data.check <- subset(data, accuracy == "0")

#speeded naming 2
data2 <- mutate(data2, enterResponse.RESP = as.character(enterResponse.RESP))
data2 <- mutate(data2, enterResponse.RESP = sapply(strsplit(data2$enterResponse.RESP, split='{', fixed =TRUE), function(x) (x[1])))
data2$enterResponse.RESP <- as.character(data2$enterResponse.RESP)
data2$enterResponse.RESP <- sapply(data2$enterResponse.RESP, toupper)
data2$enterResponse.RESP <- gsub("[ ]", "", data2$enterResponse.RESP)
data2$nameItem <- gsub("[ ]", "", data2$nameItem)
data2$accuracy <- with(data2, ifelse(nameItem == enterResponse.RESP, 1, 0))

#remove the 2 from the string and check if accurate
data2 <- mutate(data2, enterResponse.RESP = sapply(strsplit(data2$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data2$enterResponse.RESP <- as.character(data2$enterResponse.RESP)
data2$enterResponse.RESP <- sapply(data2$enterResponse.RESP, toupper)
data2$enterResponse.RESP <- gsub("[ ]", "", data2$enterResponse.RESP)
data2$nameItem <- gsub("[ ]", "", data2$nameItem)
data2$accuracy <- with(data2, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check*******************************************************************************************************************************
data.check <- subset(data2, accuracy == "0")

#speeded naming 3
data3 <- mutate(data3, enterResponse.RESP = as.character(enterResponse.RESP))
data3 <- mutate(data3, enterResponse.RESP = sapply(strsplit(data3$enterResponse.RESP, split='{', fixed =TRUE), function(x) (x[1])))
data3$enterResponse.RESP <- as.character(data3$enterResponse.RESP)
data3$enterResponse.RESP <- sapply(data3$enterResponse.RESP, toupper)
data3$enterResponse.RESP <- gsub("[ ]", "", data3$enterResponse.RESP)
data3$nameItem <- gsub("[ ]", "", data3$nameItem)
data3$accuracy <- with(data3, ifelse(nameItem == enterResponse.RESP, 1, 0))

#remove the 2 from the string and check if accurate
data3 <- mutate(data3, enterResponse.RESP = sapply(strsplit(data3$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data3$enterResponse.RESP <- as.character(data3$enterResponse.RESP)
data3$enterResponse.RESP <- sapply(data3$enterResponse.RESP, toupper)
data3$enterResponse.RESP <- gsub("[ ]", "", data3$enterResponse.RESP)
data3$nameItem <- gsub("[ ]", "", data3$nameItem)
data3$accuracy <- with(data3, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check*******************************************************************************************************************************
data.check <- subset(data3, accuracy == "0")

#rename 0s and 1s in freq and studied columns
data$freq <- with(data, ifelse(freq == "0", "LF", "HF"))
data2$freq <- with(data2, ifelse(freq == "0", "LF", "HF"))
data3$freq <- with(data3, ifelse(freq == "0", "LF", "HF"))

data$studied <- with(data, ifelse(studied == "0", "notstudied", "studied"))
data2$studied <- with(data2, ifelse(studied == "0", "notstudied", "studied"))
data2 <- subset(data2, Subject != "NA")
data3$studied <- with(data3, ifelse(studied == "0", "notstudied", "studied"))

#combine data
data.combined <- full_join(data, data2)
data.combined <- full_join(data.combined, data3)

#double check inaccurate responses to confirm spelling and delay
data.check <- subset(data.combined, accuracy == 0)

#subset, z-score by subject, and rbind
N = nrow(data.combined)
 SubjSplit = split(data.combined, data.combined$Subject) 
 zdata.combined <- matrix(NA, nrow = N, ncol = 4)
 
for(i in seq(along = SubjSplit)) {
  
  id = names(SubjSplit)[i];
  
  #created dataset for each subject
  SubjZdata.combined = data.combined[data.combined$Subject == id,]
    meanRT = mean(SubjZdata.combined$rt.trim, na.rm = TRUE)
    meanRecogRT = mean(SubjZdata.combined$recog.rt.trim, na.rm = TRUE)
    sdRT = sd(SubjZdata.combined$rt.trim, na.rm = TRUE)
    sdRecogRT = sd(SubjZdata.combined$recog.rt.trim, na.rm = TRUE)
    zdata.combined = SubjZdata.combined[, c("Subject", "enterResponse.RESP", "nameItem", "freq", "studied", "Target.RT", "recog.ACC", "recog.RT", "rt.trim", "recog.rt.trim", "data_set", "accuracy", "trialNumber")]
    zdata.combined$zrt = ((SubjZdata.combined$rt.trim) - meanRT)/sdRT
    zdata.combined$recog.zrt = ((SubjZdata.combined$recog.rt.trim) - meanRecogRT)/sdRecogRT
     
    if (i == 1)
      result = zdata.combined
    else
      result = rbind(result, zdata.combined)
  }
  
  data.combined <- result
  data.combined <- as.data.frame(data.combined)
#end loop

#second trim of z-scored RTs (any z-scored rt than -3sd and anything greather than 3sd)
data.combined$zRT <- with(data.combined, ifelse(zrt <= -3 | zrt >= 3, NA, zrt))
data.combined$zRT.r <- with(data.combined, ifelse(recog.zrt <= -3 | zrt >= 3, NA, recog.zrt))

#need to also take out response times that are less than -3 sds and greater than 3 sds
data.combined$rt.trim2 <- with(data.combined, ifelse(zrt <= -3 | zrt >= 3, NA, rt.trim))
data.combined$rt.trim2.r <- with(data.combined, ifelse(recog.zrt <= -3 | zrt >= 3, NA, recog.rt.trim))

#age variable
data.combined$age <- with(data.combined, ifelse(Subject <= 200, "YA", "OA"))

# split data1 and data2 apart again
data <- subset(data.combined, data_set == "data1")
data2 <- subset(data.combined, data_set == "data2")
data3 <- subset(data.combined, data_set == "data3")
```

```{r}
#strings with a 2 in them
#get rid of that rt
library(stringr)
data$rt.trim <- with(data, ifelse(str_detect(enterResponse.RESP, "2"), NA, data$rt.trim))
data2$rt.trim <- with(data2, ifelse(str_detect(enterResponse.RESP, "2"), NA, data2$rt.trim))
data3$rt.trim <- with(data3, ifelse(str_detect(enterResponse.RESP, "2"), NA, data3$rt.trim))

#remove the 2 from the string and check if accurate
#data1
data <- mutate(data, enterResponse.RESP = sapply(strsplit(data$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data$enterResponse.RESP <- as.character(data$enterResponse.RESP)
data$enterResponse.RESP <- sapply(data$enterResponse.RESP, toupper)
data$enterResponse.RESP <- gsub("[ ]", "", data$enterResponse.RESP)
data$nameItem <- gsub("[ ]", "", data$nameItem)
data$accuracy <- with(data, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check
data.check <- subset(data, accuracy == "0")

#data2
data2 <- mutate(data2, enterResponse.RESP = sapply(strsplit(data2$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data2$enterResponse.RESP <- as.character(data2$enterResponse.RESP)
data2$enterResponse.RESP <- sapply(data2$enterResponse.RESP, toupper)
data2$enterResponse.RESP <- gsub("[ ]", "", data2$enterResponse.RESP)
data2$nameItem <- gsub("[ ]", "", data2$nameItem)
data2$accuracy <- with(data2, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check
data.check <- subset(data2, accuracy == "0")

#data3
data3 <- mutate(data3, enterResponse.RESP = sapply(strsplit(data3$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data3$enterResponse.RESP <- as.character(data3$enterResponse.RESP)
data3$enterResponse.RESP <- sapply(data3$enterResponse.RESP, toupper)
data3$enterResponse.RESP <- gsub("[ ]", "", data3$enterResponse.RESP)
data3$nameItem <- gsub("[ ]", "", data3$nameItem)
data3$accuracy <- with(data3, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check
data.check <- subset(data, accuracy == "0")

#subset correct trials
data <- subset(data, accuracy == 1)
data2 <- subset(data2, accuracy == 1)
data3 <- subset(data3, accuracy == 1)

#add lables for study and freq
data$study_freq <- with(data, ifelse(studied == "studied" & freq == "HF", "studied_hf",
                                     ifelse(studied == "studied" & freq == "LF", "studied_lf",
                                            ifelse(studied == "notstudied" & freq == "HF", "notstudied_hf",
                                                   ifelse(studied == "notstudied" & freq == "LF", "notstudied_lf", NA)))))

data$recog <- "w/o recog"

data2$study_freq <- with(data2, ifelse(studied == "studied" & freq == "HF", "studied_hf",
                                     ifelse(studied == "studied" & freq == "LF", "studied_lf",
                                            ifelse(studied == "notstudied" & freq == "HF", "notstudied_hf",
                                                   ifelse(studied == "notstudied" & freq == "LF", "notstudied_lf", NA)))))

data2$recog <- "w recog"

data3$study_freq <- with(data3, ifelse(studied == "studied" & freq == "HF", "studied_hf",
                                     ifelse(studied == "studied" & freq == "LF", "studied_lf",
                                            ifelse(studied == "notstudied" & freq == "HF", "notstudied_hf",
                                                   ifelse(studied == "notstudied" & freq == "LF", "notstudied_lf", NA)))))

data3$recog <- "w/o recog"

data$age <- with(data, ifelse(Subject <= 200, "YA", "OA"))
data2$age <- with(data2, ifelse(Subject <= 200, "YA", "OA"))
data3$age <- with(data3, ifelse(Subject <= 200, "YA", "OA"))

IERT1 <- data %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(zRT[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(zRT[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(zRT[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(zRT[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    no_recog = mean(zRT, na.rm = TRUE),
    recog = "Block 1")
  
#data to long format and gather by condition
combined1 <- gather(IERT1, type, RT, studied_hf:no_recog)

#add in separate freq and study columns
combined1$freq <- with(combined1, ifelse(type == "studied_hf", "HF",
                                    ifelse(type == "studied_lf", "LF",
                                           ifelse(type == "notstudied_hf", "HF",
                                                  ifelse(type == "notstudied_lf", "LF", NA)))))

combined1$studied <- with(combined1, ifelse(type == "studied_hf", "studied",
                                            ifelse(type == "studied_lf", "studied",
                                                   ifelse(type == "notstudied_hf", "notstudied",
                                                          ifelse(type == "notstudied_lf", "notstudied", NA)))))

IERT2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(zRT[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(zRT[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(zRT[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(zRT[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    w_recog = mean(zRT, na.rm = TRUE),
    recog = "Block 2")

#data to long format and gather by condition
combined2 <- gather(IERT2, type, RT, studied_hf:w_recog) 

#add in separate freq and study columns
combined2$freq <- with(combined2, ifelse(type == "studied_hf", "HF",
                                    ifelse(type == "studied_lf", "LF",
                                           ifelse(type == "notstudied_hf", "HF",
                                                  ifelse(type == "notstudied_lf", "LF", NA)))))

combined2$studied <- with(combined2, ifelse(type == "studied_hf", "studied",
                                            ifelse(type == "studied_lf", "studied",
                                                   ifelse(type == "notstudied_hf", "notstudied",
                                                          ifelse(type == "notstudied_lf", "notstudied", NA)))))

IERT3 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(zRT[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(zRT[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(zRT[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(zRT[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    no_recog2 = mean(zRT, na.rm = TRUE),
    recog = "Block 3")

#data to long format and gather by condition
combined3 <- gather(IERT3, type, RT, studied_hf:no_recog2) 

#add in separate freq and study columns
combined3$freq <- with(combined3, ifelse(type == "studied_hf", "HF",
                                    ifelse(type == "studied_lf", "LF",
                                           ifelse(type == "notstudied_hf", "HF",
                                                  ifelse(type == "notstudied_lf", "LF", NA)))))

combined3$studied <- with(combined3, ifelse(type == "studied_hf", "studied",
                                            ifelse(type == "studied_lf", "studied",
                                                   ifelse(type == "notstudied_hf", "notstudied",
                                                          ifelse(type == "notstudied_lf", "notstudied", NA)))))

combined <- full_join(combined1, combined2)
combined <- full_join(combined, combined3)
combined$age <- with(combined, ifelse(Subject <= 200, "YA", "OA"))
```

## Z-Scored Response Times
### Speeded Naming
#### Study X Frequency
```{r}
#studied and freq
#means
combined.1 <- subset(combined, type %in% c("studied_hf", "studied_lf", "notstudied_hf", "notstudied_lf"))
combined.means <- summarySE(data = combined.1,
                        measurevar = "RT",
                        groupvars = c("recog", "type", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean zRTs")

combined.means$recog <- factor(combined.means$recog, levels = c("no recog", "w/ recog", "no recog2"))

combined.2 <- subset(combined, type %in% c("no_recog", "w_recog", "no_recog2"))
combined.means1 <- summarySE(data = combined.2,
                        measurevar = "RT",
                        groupvars = c("recog", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

combined.means1$age <- factor(combined.means1$age, levels = c("YA", "OA"))
combined.means1$recog <- factor(combined.means1$recog, levels = c("Block 1", "Block 2", "Block 3"))

#plot 2
ggplot(combined.means1, aes(x = recog,
                           y = RT,
                           fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "dodgerblue3", "lightblue")) +
  labs(x = "Block Type",
       y = "Z-Scored RT", 
       title = "Speeded Naming zRTs by Block Type", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) + 
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(-.5, .75))


ggsave("~/Desktop/IE3.pdf", width = 13, height = 7, units = "in", dpi = 150) 

# test
pander(anova(aov(RT ~ age*studied*freq*recog, data = combined.1)))
```

#### Age X Recog (only SN1 & SN3)
```{r}
combined1.3 <- subset(combined, recog !="Block 2")

#means
combined1.3.1 <- subset(combined1.3, type %in% c("studied_hf", "studied_lf", "notstudied_hf", "notstudied_lf"))
combined.means <- summarySE(data = combined1.3.1,
                        measurevar = "RT",
                        groupvars = c("recog", "type", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean zRTs")

combined.means$recog <- factor(combined.means$recog, levels = c("no recog", "no recog2"))

combined1.3.2 <- subset(combined1.3, type %in% c("no_recog", "w_recog", "no_recog2"))
combined.means1 <- summarySE(data = combined1.3.2,
                        measurevar = "RT",
                        groupvars = c("recog", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

combined.means1$age <- factor(combined.means1$age, levels = c("YA", "OA"))
combined.means1$recog <- factor(combined.means1$recog, levels = c("Block 1", "Block 3"))

#plot
ggplot(combined.means, aes(x = type,
                           y = RT,
                           fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "white")) +
  labs(y = "Z-Scored RT", 
       title = "Speeded Naming w/ and w/o Recog zRTs", 
       fill = "W or W/o Recog") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) 

#plot 2
ggplot(combined.means1, aes(x = recog,
                           y = RT,
                           fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "white")) +
  labs(x = "Block Type",
       y = "Z-Scored RT", 
       title = "Speeded Naming zRTs by Block Type", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(-.5, .25))


ggsave("~/Desktop/IE3_persev.pdf", width = 13, height = 7, units = "in", dpi = 150) 

#anova
pander(anova(aov(RT ~ age*studied*freq*recog, data = combined1.3.1)))
```

##### Block 2 Halves
```{r}
block2 <- data2
block2$half <- with(block2, ifelse(trialNumber < 21, "half1", "half2"))

block2 <- block2 %>%
  group_by(Subject) %>%
  summarize(
    half1 = mean(zRT[which(half == "half1")], na.rm = TRUE),
    half2 = mean(zRT[which(half == "half2")], na.rm = TRUE),
    age = unique(age))

block2.long <- gather(block2, half, zRT, half1:half2)

block2.means <- summarySE(data = block2.long,
                          measurevar = "zRT",
                          groupvars = c("half", "age"),
                          na.rm = FALSE,
                          conf.interval = 0.95,
                          .drop = TRUE)

block2.means$age <- factor(block2.means$age, levels = c("YA", "OA"))
#combined.means1$recog <- factor(combined.means1$recog, levels = c("Block 1", "Block 3"))

ggplot(block2.means, aes(x = half,
                         y = zRT,
                         fill = factor(half))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "white")) +
  labs(y = "Z-Scored RT", 
       title = "Block 2 First and Second Halves", 
       fill = "Block 2 Half") +
  geom_errorbar(aes (ymin = zRT - se, ymax = zRT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) 

#anova
pander(anova(aov(zRT ~ age*half, data = block2.long)))
```

##### Block 3 Halves
```{r}
block3 <- data3
block3$half <- with(block3, ifelse(trialNumber < 21, "half1", "half2"))

block3 <- block3 %>%
  group_by(Subject) %>%
  summarize(
    half1 = mean(zRT[which(half == "half1")], na.rm = TRUE),
    half2 = mean(zRT[which(half == "half2")], na.rm = TRUE),
    age = unique(age))

block3.long <- gather(block3, half, zRT, half1:half2)

block3.means <- summarySE(data = block3.long,
                          measurevar = "zRT",
                          groupvars = c("half", "age"),
                          na.rm = FALSE,
                          conf.interval = 0.95,
                          .drop = TRUE)

block3.means$age <- factor(block3.means$age, levels = c("YA", "OA"))
combined.means1$recog <- factor(combined.means1$recog, levels = c("Block 1", "Block 3"))

ggplot(block3.means, aes(x = half,
                         y = zRT,
                         fill = factor(half))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "white")) +
  labs(y = "Z-Scored RT", 
       title = "Block 3 First and Second Halves", 
       fill = "Block 3 Half") +
  geom_errorbar(aes (ymin = zRT - se, ymax = zRT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) 

#anova
pander(anova(aov(zRT ~ age*half, data = block3.long)))
```

#### WFE by Block
##### Block 1
```{r}
combined.bl1 <- subset(combined, combined$recog == "Block 1")
combined.bl1 <- subset(combined.bl1, combined.bl1$type != "no_recog")
combined.bl1 <- subset(combined.bl1, combined.bl1$type != "w_recog")

#means
combined.means <- summarySE(data = combined.bl1,
                        measurevar = "RT",
                        groupvars = c("type", "studied", "freq", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean zRTs - Block 1 Only")

combined.means$age <- factor(combined.means$age, levels = c("YA", "OA"))
combined.means$freq <- factor(combined.means$freq, levels = c("LF", "HF"))
combined.means$studied <- factor(combined.means$studied, levels = c("notstudied", "studied"))

#plot
ggplot(combined.means, aes(x = freq,
                           y = RT,
                           fill = freq)) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "grey50")) +
  labs(x = "Word Frequency",
       y = "Z-Scored RT") +
  guides(fill = guide_legend(title = "Word Frequency")) +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age*studied, scales = "free_x", nrow = 1, ncol = 4) +
  theme(axis.text = element_text(size = rel(0.5)))  +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(-.6, .5))


ggsave("~/Desktop/IE2_WFE_Block1.pdf", width = 13, height = 7, units = "in", dpi = 150)
```

##### Block 2
```{r}
combined.bl2 <- subset(combined, combined$recog == "Block 2")
combined.bl2 <- subset(combined.bl2, combined.bl2$type != "no_recog")
combined.bl2 <- subset(combined.bl2, combined.bl2$type != "w_recog")

#means
combined.means <- summarySE(data = combined.bl2,
                        measurevar = "RT",
                        groupvars = c("type", "studied", "freq", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean zRTs - Block 2 Only")

combined.means$age <- factor(combined.means$age, levels = c("YA", "OA"))
combined.means$freq <- factor(combined.means$freq, levels = c("LF", "HF"))
combined.means$studied <- factor(combined.means$studied, levels = c("notstudied", "studied"))

#plot
ggplot(combined.means, aes(x = freq,
                           y = RT,
                           fill = freq)) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "grey50")) +
  labs(x = "Word Frequency",
       y = "Z-Scored RT") +
  guides(fill = guide_legend(title = "Word Frequency")) +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age*studied, scales = "free_x", nrow = 1, ncol = 4) +
  theme(axis.text = element_text(size = rel(0.5)))  +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(-.6, .75))


ggsave("~/Desktop/IE2_WFE_Block2.pdf", width = 13, height = 7, units = "in", dpi = 150)
```

##### Block 3
```{r}
combined.bl3 <- subset(combined, combined$recog == "Block 3")
combined.bl3 <- subset(combined.bl3, combined.bl3$type != "no_recog")
combined.bl3 <- subset(combined.bl3, combined.bl3$type != "w_recog")
combined.bl3 <- subset(combined.bl3, combined.bl3$type != "no_recog2")

#means
combined.means <- summarySE(data = combined.bl3,
                        measurevar = "RT",
                        groupvars = c("type", "studied", "freq", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean zRTs - Block 3 Only")

combined.means$age <- factor(combined.means$age, levels = c("YA", "OA"))
combined.means$freq <- factor(combined.means$freq, levels = c("LF", "HF"))
combined.means$studied <- factor(combined.means$studied, levels = c("notstudied", "studied"))

#plot
ggplot(combined.means, aes(x = freq,
                           y = RT,
                           fill = freq)) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "grey50")) +
  labs(x = "Word Frequency",
       y = "Z-Scored RT") +
  guides(fill = guide_legend(title = "Word Frequency")) +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age*studied, scales = "free_x", nrow = 1, ncol = 4) +
  theme(axis.text = element_text(size = rel(0.5)))  +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(-.6, .5))


ggsave("~/Desktop/IE2_WFE_Block3.pdf", width = 13, height = 7, units = "in", dpi = 150)
```

#### Priming Scores
```{r}
#studied vs not studied
#1
study1 <- data %>%
  group_by(Subject) %>%
  summarize(
    notstudied_norecog = mean(zRT[which(studied == "notstudied")], na.rm = TRUE),
    studied_norecog = mean(zRT[which(studied == "studied")], na.rm = TRUE),
    age = unique(age))

#2
study2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    notstudied_recog = mean(zRT[which(studied == "notstudied")], na.rm = TRUE),
    studied_recog = mean(zRT[which(studied == "studied")], na.rm = TRUE),
    age = unique(age))

#3
study3 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    notstudied_norecog2 = mean(zRT[which(studied == "notstudied")], na.rm = TRUE),
    studied_norecog2 = mean(zRT[which(studied == "studied")], na.rm = TRUE),
    age = unique(age))

#combine
study <- full_join(study1, study2)
study <- full_join(study, study3)

#create priming scores
study$priming_norecog <- study$notstudied_norecog - study$studied_norecog
study$priming_recog <- study$notstudied_recog - study$studied_recog
study$priming_norecog2 <- study$notstudied_norecog2 - study$studied_norecog2

drops <- c("notstudied_norecog", "studied_norecog", "notstudied_recog", "studied_recog", "notstudied_norecog2", "studied_norecog2")
study <- study[ , !(names(study) %in% drops)]

study.long <- gather(study, recog, primingScore, priming_norecog:priming_norecog2)

study.long$recog <- as.factor(study.long$recog)
study.long$age <- as.factor(study.long$age)

#means
priming.means <- summarySE(data = study.long,
                           measurevar = "primingScore",
                           groupvars = c("age", "recog"),
                           na.rm = FALSE,
                           conf.interval = 0.95,
                           .drop = TRUE)

kable(priming.means, digits = 2, caption = "Speeded Naming Mean Priming zRTs")

priming.means$recog <- factor(priming.means$recog, levels = c("priming_norecog", "priming_recog", "priming_norecog2"))

#plot
ggplot(priming.means, aes(x = recog,
                          y = primingScore,
                          fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "dodgerblue3", "white")) +
  labs(y = "Priming zRT", 
       title = "Speeded Naming Priming Score (based on zRTs)", 
       fill = "W or W/o Recog") +
  geom_errorbar(aes (ymin = primingScore - se, ymax = primingScore + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4)

#anova
#pander it to make it pretty
pander(anova(aov(primingScore ~ age*recog, data = study.long)))
```

#### Word Frequency Effects
```{r}
#1
freq1 <- data %>%
  group_by(Subject) %>%
  summarize(
    LF_norecog = mean(zRT[which(freq == "LF")], na.rm = TRUE),
    HF_norecog = mean(zRT[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#2
freq2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    LF_recog = mean(zRT[which(freq == "LF")], na.rm = TRUE),
    HF_recog = mean(zRT[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#3
freq3 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    LF_norecog2 = mean(zRT[which(freq == "LF")], na.rm = TRUE),
    HF_norecog2 = mean(zRT[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#combine
freq <- full_join(freq1, freq2)
freq <- full_join(freq, freq3)

#create priming scores
freq$Block1 <- freq$LF_norecog - freq$HF_norecog
freq$Block2 <- freq$LF_recog - freq$HF_recog
freq$Block3 <- freq$LF_norecog2 - freq$HF_norecog2

drops <- c("LF_norecog", "HF_norecog", "LF_recog", "HF_recog", "LF_norecog2", "HF_norecog2")
freq <- freq[ , !(names(freq) %in% drops)]

freq.long <- gather(freq, recog, wfe, Block1:Block3)

freq.long$recog <- as.factor(freq.long$recog)
freq.long$age <- as.factor(freq.long$age)

#means
wfe.means <- summarySE(data = freq.long,
                       measurevar = "wfe",
                       groupvars = c("age", "recog"),
                       na.rm = FALSE,
                       conf.interval = 0.95,
                       .drop = TRUE)

kable(wfe.means, digits = 2, caption = "Speeded Naming Mean WFE zRTs")

wfe.means$age <- factor(wfe.means$age, levels = c("YA", "OA"))                                                 
wfe.means$recog <- factor(wfe.means$recog, levels = c("Block1", "Block2", "Block3"))

#plot
ggplot(wfe.means, aes(x = recog,
                      y = wfe,
                      fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "dodgerblue3", "lightblue")) +
  labs(x = "Block Type",
       y = "Word Frequency Effect from zRTs", 
       title = "Word Frequency Effect from zRTs by Age", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = wfe - se, ymax = wfe + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") 

ggsave("~/Desktop/E2_WFE.pdf", width = 13, height = 10, units = "in", dpi = 150)

#anova
#pander it to make it pretty
pander(anova(aov(wfe ~ age*recog, data = freq.long)))
```

##### No Block 3
```{r}
#1
freq1 <- data %>%
  group_by(Subject) %>%
  summarize(
    LF_norecog = mean(zRT[which(freq == "LF")], na.rm = TRUE),
    HF_norecog = mean(zRT[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#2
freq2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    LF_recog = mean(zRT[which(freq == "LF")], na.rm = TRUE),
    HF_recog = mean(zRT[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#combine
freq <- full_join(freq1, freq2)

#create priming scores
freq$Block1 <- freq$LF_norecog - freq$HF_norecog
freq$Block2 <- freq$LF_recog - freq$HF_recog

drops <- c("LF_norecog", "HF_norecog", "LF_recog", "HF_recog", "LF_norecog2")
freq <- freq[ , !(names(freq) %in% drops)]

freq.long <- gather(freq, recog, wfe, Block1:Block2)

freq.long$recog <- as.factor(freq.long$recog)
freq.long$age <- as.factor(freq.long$age)

#means
wfe.means <- summarySE(data = freq.long,
                       measurevar = "wfe",
                       groupvars = c("age", "recog"),
                       na.rm = FALSE,
                       conf.interval = 0.95,
                       .drop = TRUE)

kable(wfe.means, digits = 2, caption = "Speeded Naming Mean WFE zRTs")
                                                 
wfe.means$age <- factor(wfe.means$age, levels = c("YA", "OA"))  
wfe.means$recog <- factor(wfe.means$recog, levels = c("Block1", "Block2"))

#plot
ggplot(wfe.means, aes(x = recog,
                      y = wfe,
                      fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "dodgerblue3")) +
  labs(x = "Block Type",
       y = "Word Frequency Effect from zRTs", 
       title = "Word Frequency Effect from zRTs by Age", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = wfe - se, ymax = wfe + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") 

ggsave("~/Desktop/E2_WFE_noblock3.pdf", width = 13, height = 10, units = "in", dpi = 150)

#anova
#pander it to make it pretty
pander(anova(aov(wfe ~ age*recog, data = freq.long)))

#t tests
freq.wide <- spread(freq.long, recog, wfe)
freq.wide.ya <- subset(freq.wide, age == "YA")
freq.wide.oa <- subset(freq.wide, age == "OA")
pander(t.test(freq.wide.ya$Block1, freq.wide.ya$Block2))
pander(t.test(freq.wide.oa$Block1, freq.wide.oa$Block2))
```

### Recognition
#### Study X Frequency
```{r}
recog.rt <- subset(data2, recog.ACC == "1")
recog.rt <- subset(recog.rt, Subject != "317")

recog <- recog.rt %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(zRT.r[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(zRT.r[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(zRT.r[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(zRT.r[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    age = unique(age))
  
#data to long format and gather by condition
recog.long <- gather(recog, type, RT, studied_hf:notstudied_lf) 

recog.means <- summarySE(data = recog.long, 
                            measurevar = "RT",
                            groupvars = c("type", "age"))

kable(recog.means, digits = 2, caption = "Recognition Mean zRTs")

recog.long$study <- with(recog.long, ifelse(type %in% c("notstudied_hf", "notstudied_lf"), "notstudied", "studied"))
recog.long$freq <- with(recog.long, ifelse(type %in% c("notstudied_hf", "studied_hf"), "HF", "LF"))

recog.means <- summarySE(data = recog.long, 
                            measurevar = "RT",
                            groupvars = c("study", "freq", "type", "age"))

##delete this stuff 
recog.means$type <- factor(recog.means$type, levels=c("notstudied_hf", "notstudied_lf", "studied_hf", "studied_lf"))

ggplot(recog.means, aes(x = type,
                        y = RT, 
                        fill = factor(study))) + 
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black") +
  labs(y = "Z-Scored RT", 
       title = "Recognition RT") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  scale_fill_manual(values = c("black", "white")) +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14, face = "bold")) +
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4)

recog.means <- summarySE(data = recog.long, 
                            measurevar = "RT",
                            groupvars = c("study", "age"))

ggplot(recog.means, aes(x = study,
                        y = RT)) + 
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black") +
  labs(y = "Z-Scored RT", 
       title = "Recognition RT") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  scale_fill_manual(values = c("black", "white")) +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14, face = "bold")) +
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4)


#anova
ezanova <- ezANOVA(data = recog.long, 
                   dv = RT,
                   wid = Subject,
                   within = c("study", "freq"),
                   between = age)

#pander it to make it pretty
pander(ezanova$ANOVA, caption = "Implict Encoding zRTs", digits = 2)
```

##### Recog Cost and Recog Acc
```{r}
# calc diff between no recog and recog RTs
combined$recog <- gsub(" ", "", combined$recog)
combined <- subset(combined, type %in% c("studied_hf", "studied_lf", "notstudied_hf", "notstudied_lf"))

cov <- combined %>%
  group_by(Subject, recog) %>%
  summarize(
    RT = mean(RT, na.rm = T),
    age = unique(age))

cov <- spread(cov, recog, RT)

recognitionAcc <- data2 %>%
  group_by(Subject) %>%
  summarize(
    recogAcc = sum(recog.ACC/40, na.rm = TRUE),
    age = unique(age))

switchCostwRecogAcc <- full_join(cov, recognitionAcc)
switchCostwRecogAcc$recogCost <- switchCostwRecogAcc$Block2 - switchCostwRecogAcc$Block1

pander(summary(aov(recogCost ~ age*recogAcc, data = switchCostwRecogAcc)))

pander(cor.test(switchCostwRecogAcc$recogCost, switchCostwRecogAcc$recogAcc))

ggplot(switchCostwRecogAcc, aes(x = recogAcc, y = recogCost)) +
  geom_point(aes(shape = age, color = age), size = 7) +
  scale_color_manual(values = c("black", "gray50")) +
  geom_smooth(method = lm,   # Add linear regression line
                se = TRUE) +
  labs(x = "Proportion of Correctly Recognized Words",
       y = "Block 2 zRT - Block 1 zRT",
       title = "Recognition Accuracy by Block Cost") +
  annotate(x = .65, y = -.25, 
         label = paste("R = -0.39, p < 0.001"), 
         geom = "text", size = 7) +
  theme_bw() +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") 

ggsave("~/Desktop/RecogAccXRecogCost_E2.pdf", width = 13, height = 7, units = "in", dpi = 150)
```

## Raw, Trimmed Response Times
### Speeded Naming
```{r}
#strings with a 2 in them
#get rid of that rt
library(stringr)
data$rt.trim <- with(data, ifelse(str_detect(enterResponse.RESP, "2"), NA, data$rt.trim))
data2$rt.trim <- with(data2, ifelse(str_detect(enterResponse.RESP, "2"), NA, data2$rt.trim))

#remove the 2 from the string and check if accurate
data <- mutate(data, enterResponse.RESP = sapply(strsplit(data$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data$enterResponse.RESP <- as.character(data$enterResponse.RESP)
data$enterResponse.RESP <- sapply(data$enterResponse.RESP, toupper)
data$enterResponse.RESP <- gsub("[ ]", "", data$enterResponse.RESP)
data$nameItem <- gsub("[ ]", "", data$nameItem)
data$accuracy <- with(data, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check
data.check <- subset(data, accuracy == "0")

data2 <- mutate(data2, enterResponse.RESP = sapply(strsplit(data2$enterResponse.RESP, split='2', fixed =TRUE), function(x) (x[1])))
data2$enterResponse.RESP <- as.character(data2$enterResponse.RESP)
data2$enterResponse.RESP <- sapply(data2$enterResponse.RESP, toupper)
data2$enterResponse.RESP <- gsub("[ ]", "", data2$enterResponse.RESP)
data2$nameItem <- gsub("[ ]", "", data2$nameItem)
data2$accuracy <- with(data2, ifelse(nameItem == enterResponse.RESP, 1, 0))

#check
data.check <- subset(data2, accuracy == "0")

data <- subset(data, accuracy == 1)
data2 <- subset(data2, accuracy == 1)

data$study_freq <- with(data, ifelse(studied == "studied" & freq == "HF", "studied_hf",
                                     ifelse(studied == "studied" & freq == "LF", "studied_lf",
                                            ifelse(studied == "notstudied" & freq == "HF", "notstudied_hf",
                                                   ifelse(studied == "notstudied" & freq == "LF", "notstudied_lf", NA)))))

data$block <- "Block1"

data2$study_freq <- with(data2, ifelse(studied == "studied" & freq == "HF", "studied_hf",
                                     ifelse(studied == "studied" & freq == "LF", "studied_lf",
                                            ifelse(studied == "notstudied" & freq == "HF", "notstudied_hf",
                                                   ifelse(studied == "notstudied" & freq == "LF", "notstudied_lf", NA)))))

data2$block <- "Block2"

data$age <- with(data, ifelse(Subject <= 200, "YA", "OA"))
data2$age <- with(data2, ifelse(Subject <= 200, "YA", "OA"))

IERT1 <- data %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(rt.trim2[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(rt.trim2[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(rt.trim2[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(rt.trim2[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    no_recog = mean(rt.trim2, na.rm = TRUE),
    block = "Block1")
  
#data to long format and gather by condition
combined1 <- gather(IERT1, type, RT, studied_hf:no_recog)

#add in separate freq and study columns
combined1$freq <- with(combined1, ifelse(type == "studied_hf", "HF",
                                    ifelse(type == "studied_lf", "LF",
                                           ifelse(type == "notstudied_hf", "HF",
                                                  ifelse(type == "notstudied_lf", "LF", NA)))))

combined1$studied <- with(combined1, ifelse(type == "studied_hf", "studied",
                                            ifelse(type == "studied_lf", "studied",
                                                   ifelse(type == "notstudied_hf", "notstudied",
                                                          ifelse(type == "notstudied_lf", "notstudied", NA)))))

IERT2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(rt.trim2[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(rt.trim2[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(rt.trim2[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(rt.trim2[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    w_recog = mean(rt.trim2, na.rm = TRUE),
    block = "Block2")

#data to long format and gather by condition
combined2 <- gather(IERT2, type, RT, studied_hf:w_recog) 

#add in separate freq and study columns
combined2$freq <- with(combined2, ifelse(type == "studied_hf", "HF",
                                    ifelse(type == "studied_lf", "LF",
                                           ifelse(type == "notstudied_hf", "HF",
                                                  ifelse(type == "notstudied_lf", "LF", NA)))))

combined2$studied <- with(combined2, ifelse(type == "studied_hf", "studied",
                                            ifelse(type == "studied_lf", "studied",
                                                   ifelse(type == "notstudied_hf", "notstudied",
                                                          ifelse(type == "notstudied_lf", "notstudied", NA)))))

IERT3 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(rt.trim2[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(rt.trim2[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(rt.trim2[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(rt.trim2[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    no_recog2 = mean(rt.trim2, na.rm = TRUE),
    block = "Block3")

#data to long format and gather by condition
combined3 <- gather(IERT3, type, RT, studied_hf:no_recog2) 

#add in separate freq and study columns
combined3$freq <- with(combined3, ifelse(type == "studied_hf", "HF",
                                    ifelse(type == "studied_lf", "LF",
                                           ifelse(type == "notstudied_hf", "HF",
                                                  ifelse(type == "notstudied_lf", "LF", NA)))))

combined3$studied <- with(combined3, ifelse(type == "studied_hf", "studied",
                                            ifelse(type == "studied_lf", "studied",
                                                   ifelse(type == "notstudied_hf", "notstudied",
                                                          ifelse(type == "notstudied_lf", "notstudied", NA)))))

combined <- full_join(combined1, combined2)
combined <- full_join(combined, combined3)
combined$age <- with(combined, ifelse(Subject <= 200, "YA", "OA"))
```

#### Study X Frequency
```{r}
#studied and freq
#means
combined.1 <- subset(combined, type %in% c("studied_hf", "studied_lf", "notstudied_hf", "notstudied_lf"))
combined.means <- summarySE(data = combined.1,
                        measurevar = "RT",
                        groupvars = c("block", "type", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean Raw, Trimmed RTs")

combined.means$block <- factor(combined.means$block, levels = c("Block1", "Block2", "Block3"))

combined.2 <- subset(combined, type %in% c("no_recog", "w_recog", "no_recog2"))
combined.means1 <- summarySE(data = combined.2,
                        measurevar = "RT",
                        groupvars = c("block", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

combined.means1$age <- factor(combined.means1$age, levels = c("YA", "OA"))
combined.means1$block <- factor(combined.means1$block, levels = c("Block1", "Block2", "Block3"))

#plot
ggplot(combined.means, aes(x = type,
                           y = RT,
                           fill = factor(block))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "snow3", "white")) +
  labs(y = "Raw, Trimmed RT", 
       title = "Speeded Naming w/ and w/o Recog  Raw, Trimmed RTs", 
       fill = "W or W/o Recog") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) 

#plot 2
ggplot(combined.means1, aes(x = block,
                           y = RT,
                           fill = factor(block))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "dodgerblue3", "lightblue")) +
  labs(x = "Block Type",
       y = "Raw RT", 
       title = "Speeded Naming Raw RTs by Block Type", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) + 
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(200, 900))


ggsave("~/Desktop/IE3_rawRTs.pdf", width = 13, height = 7, units = "in", dpi = 150) 

#anova
pander(anova(aov(RT ~ age*studied*freq*block, data = combined.1)))
```

#### Age X Recog (only SN1 & SN3)
```{r}
combined1.3 <- subset(combined, block !="Block2")

#means
combined1.3.1 <- subset(combined1.3, type %in% c("studied_hf", "studied_lf", "notstudied_hf", "notstudied_lf"))
combined.means <- summarySE(data = combined1.3.1,
                        measurevar = "RT",
                        groupvars = c("block", "type", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean zRTs")

combined.means$block <- factor(combined.means$block, levels = c("Block1", "Block3"))

combined1.3.2 <- subset(combined1.3, block %in% c("Block1", "Block3"))
combined.means1 <- summarySE(data = combined1.3.2,
                        measurevar = "RT",
                        groupvars = c("block", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

combined.means1$block <- factor(combined.means1$block, levels = c("Block1", "Block3"))
combined.means1$age <- factor(combined.means1$age, levels = c("YA", "OA"))

#plot
ggplot(combined.means, aes(x = type,
                           y = RT,
                           fill = factor(block))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "white")) +
  labs(y = "Z-Scored RT", 
       title = "Speeded Naming w/ and w/o Recog zRTs", 
       fill = "W or W/o Recog") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) 

#plot 2
ggplot(combined.means1, aes(x = block,
                           y = RT,
                           fill = factor(block))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "white")) +
  labs(x = "Block Type",
       y = "Raw RT", 
       title = "Speeded Naming Raw RTs by Block Type", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(300, 650))

ggsave("~/Desktop/IE3_persev_raw.pdf", width = 13, height = 7, units = "in", dpi = 150) 

#anova
pander(anova(aov(RT ~ age*studied*freq*block, data = combined1.3.1)))
```

#### WFE by Block
##### Block 1
```{r}
combined.bl1 <- subset(combined, combined$block == "Block1")
combined.bl1 <- subset(combined.bl1, combined.bl1$type != "no_recog")

#means
combined.means <- summarySE(data = combined.bl1,
                        measurevar = "RT",
                        groupvars = c("type", "studied", "freq", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean Raw RTs - Block 1 Only")

combined.means$age <- factor(combined.means$age, levels = c("YA", "OA"))
combined.means$freq <- factor(combined.means$freq, levels = c("LF", "HF"))
combined.means$studied <- factor(combined.means$studied, levels = c("notstudied", "studied"))

#plot
ggplot(combined.means, aes(x = freq,
                           y = RT,
                           fill = freq)) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "grey50")) +
  labs(x = "Word Frequency",
       y = "Raw RT",
       title = "Speeded Naming Raw RTs by Word Frequency - Block 1") +
  guides(fill = guide_legend(title = "Word Frequency")) +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age*studied, scales = "free_x", nrow = 1, ncol = 4) +
  theme(axis.text = element_text(size = rel(0.5)))  +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") +
  coord_cartesian(ylim = c(250, 900))

ggsave("~/Desktop/IE2_WFE_Block1_rawRTs.pdf", width = 13, height = 7, units = "in", dpi = 150)

#anova
pander(anova(aov(RT ~ age*studied*freq, data = combined.bl1)))
```

##### Block 2
```{r}
combined.bl2 <- subset(combined, combined$block == "Block2")
combined.bl2 <- subset(combined.bl2, combined.bl2$type != "w_recog")

#means
combined.means <- summarySE(data = combined.bl2,
                        measurevar = "RT",
                        groupvars = c("type", "studied", "freq", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean Raw RTs - Block 2 Only")

combined.means$age <- factor(combined.means$age, levels = c("YA", "OA"))
combined.means$freq <- factor(combined.means$freq, levels = c("LF", "HF"))
combined.means$studied <- factor(combined.means$studied, levels = c("notstudied", "studied"))

#plot
ggplot(combined.means, aes(x = freq,
                           y = RT,
                           fill = freq)) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "grey50")) +
  labs(x = "Word Frequency",
       y = "Z-Scored RT",
       title = "Speeded Naming Raw RTs by Word Frequency - Block 2") +
  guides(fill = guide_legend(title = "Word Frequency")) +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age*studied, scales = "free_x", nrow = 1, ncol = 4) +
  theme(axis.text = element_text(size = rel(0.5)))  +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") +
  coord_cartesian(ylim = c(250, 900))


ggsave("~/Desktop/IE2_WFE_Block3_rawRTs.pdf", width = 13, height = 7, units = "in", dpi = 150)

#anova
pander(anova(aov(RT ~ age*studied*freq, data = combined.bl2)))
```
##### Block 3
```{r}
combined.bl3 <- subset(combined, combined$block == "Block3")
combined.bl3 <- subset(combined.bl3, combined.bl3$type != "no_recog2")

#means
combined.means <- summarySE(data = combined.bl3,
                        measurevar = "RT",
                        groupvars = c("type", "studied", "freq", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean Raw RTs - Block 3 Only")

combined.means$age <- factor(combined.means$age, levels = c("YA", "OA"))
combined.means$freq <- factor(combined.means$freq, levels = c("LF", "HF"))
combined.means$studied <- factor(combined.means$studied, levels = c("notstudied", "studied"))

#plot
ggplot(combined.means, aes(x = freq,
                           y = RT,
                           fill = freq)) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "grey50")) +
  labs(x = "Word Frequency",
       y = "Raw RT") +
  guides(fill = guide_legend(title = "Word Frequency")) +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age*studied, scales = "free_x", nrow = 1, ncol = 4) +
  theme(axis.text = element_text(size = rel(0.5)))  +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") +
  coord_cartesian(ylim = c(250, 650))


ggsave("~/Desktop/IE2_WFE_Block3_rawRTs.pdf", width = 13, height = 7, units = "in", dpi = 150)

#anova
pander(anova(aov(RT ~ age*studied*freq, data = combined.bl3)))
```

#### Priming Scores
```{r}
#studied vs not studied
#1
study1 <- data %>%
  group_by(Subject) %>%
  summarize(
    notstudied_norecog = mean(rt.trim2[which(studied == "notstudied")], na.rm = TRUE),
    studied_norecog = mean(rt.trim2[which(studied == "studied")], na.rm = TRUE),
    age = unique(age))

#2
study2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    notstudied_recog = mean(rt.trim2[which(studied == "notstudied")], na.rm = TRUE),
    studied_recog = mean(rt.trim2[which(studied == "studied")], na.rm = TRUE),
    age = unique(age))

#3
study3 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    notstudied_recog2 = mean(rt.trim2[which(studied == "notstudied")], na.rm = TRUE),
    studied_recog2 = mean(rt.trim2[which(studied == "studied")], na.rm = TRUE),
    age = unique(age))

#combine
study <- full_join(study1, study2)
study <- full_join(study, study3)

#create priming scores
study$priming_norecog <- study$notstudied_norecog - study$studied_norecog
study$priming_recog <- study$notstudied_recog - study$studied_recog
study$priming_recog2 <- study$notstudied_recog2 - study$studied_recog2

drops <- c("notstudied_norecog", "studied_norecog", "notstudied_recog", "studied_recog", "notstudied_recog2", "studied_recog2")
study <- study[ , !(names(study) %in% drops)]

study.long <- gather(study, recog, primingScore, priming_norecog:priming_recog2)

study.long$recog <- as.factor(study.long$recog)
study.long$age <- as.factor(study.long$age)

#means
priming.means <- summarySE(data = study.long,
                           measurevar = "primingScore",
                           groupvars = c("age", "recog"),
                           na.rm = FALSE,
                           conf.interval = 0.95,
                           .drop = TRUE)

kable(priming.means, digits = 2, caption = "Speeded Naming Mean Priming Raw, Trimmed RTs")

#plot
ggplot(priming.means, aes(x = recog,
                          y = primingScore,
                          fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "snow3", "white")) +
  labs(y = "Raw, Trimmed Priming RT", 
       title = "Speeded Naming Priming Score (based on raw, trimmed RTs)", 
       fill = "W or W/o Recog") +
  geom_errorbar(aes (ymin = primingScore - se, ymax = primingScore + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4)

#anova
ezanova <- ezANOVA(data = study.long, 
                   dv = primingScore,
                   wid = Subject,
                   within = c("recog"),
                   between = age)

#pander it to make it pretty
pander(ezanova$ANOVA, caption = "Priming Scores (based on raw, trimmed RTs)")
```

#### Word Frequency Effects
```{r}
#1
freq1 <- data %>%
  group_by(Subject) %>%
  summarize(
    LF_norecog = mean(rt.trim2[which(freq == "LF")], na.rm = TRUE),
    HF_norecog = mean(rt.trim2[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#2
freq2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    LF_recog = mean(rt.trim2[which(freq == "LF")], na.rm = TRUE),
    HF_recog = mean(rt.trim2[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#3
freq3 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    LF_norecog2 = mean(rt.trim2[which(freq == "LF")], na.rm = TRUE),
    HF_norecog2 = mean(rt.trim2[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#combine
freq <- full_join(freq1, freq2)
freq <- full_join(freq, freq3)

#create priming scores
freq$Block1 <- freq$LF_norecog - freq$HF_norecog
freq$Block2 <- freq$LF_recog - freq$HF_recog
freq$Block3 <- freq$LF_norecog2 - freq$HF_norecog2

drops <- c("LF_norecog", "HF_norecog", "LF_recog", "HF_recog", "LF_norecog2", "HF_norecog2")
freq <- freq[ , !(names(freq) %in% drops)]

freq.long <- gather(freq, recog, wfe, Block1:Block3)

freq.long$recog <- as.factor(freq.long$recog)
freq.long$age <- as.factor(freq.long$age)

#means
wfe.means <- summarySE(data = freq.long,
                       measurevar = "wfe",
                       groupvars = c("age", "recog"),
                       na.rm = FALSE,
                       conf.interval = 0.95,
                       .drop = TRUE)

kable(wfe.means, digits = 2, caption = "Speeded Naming Mean WFE raw, trimmed RTs")

wfe.means$recog <- factor(wfe.means$recog, levels = c("Block1", "Block2", "Block3"))
wfe.means$age <- factor(wfe.means$age, levels = c("YA", "OA"))

#plot
ggplot(wfe.means, aes(x = recog,
                      y = wfe,
                      fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "dodgerblue3", "lightblue")) +
  labs(x = "Block Type",
       y = "Word Frequency Effect from Raw RTs", 
       title = "Word Frequency Effect from Raw RTs by Age", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = wfe - se, ymax = wfe + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(-20, 80)) 

ggsave("~/Desktop/E2_WFE_raw.pdf", width = 13, height = 10, units = "in", dpi = 150)

#anova
#pander it to make it pretty
pander(anova(aov(wfe ~ age*recog, data = freq.long)))

# permutation testing
library(lmPerm)
pander(anova(aovp(wfe ~ age*recog, data = freq.long)))
```

##### No Block 3
```{r}
#1
freq1 <- data %>%
  group_by(Subject) %>%
  summarize(
    LF_norecog = mean(rt.trim2[which(freq == "LF")], na.rm = TRUE),
    HF_norecog = mean(rt.trim2[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#2
freq2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    LF_recog = mean(rt.trim2[which(freq == "LF")], na.rm = TRUE),
    HF_recog = mean(rt.trim2[which(freq == "HF")], na.rm = TRUE),
    age = unique(age))

#combine
freq <- full_join(freq1, freq2)

#create priming scores
freq$Block1 <- freq$LF_norecog - freq$HF_norecog
freq$Block2 <- freq$LF_recog - freq$HF_recog

drops <- c("LF_norecog", "HF_norecog", "LF_recog", "HF_recog", "LF_norecog2")
freq <- freq[ , !(names(freq) %in% drops)]

freq.long <- gather(freq, recog, wfe, Block1:Block2)

freq.long$recog <- as.factor(freq.long$recog)
freq.long$age <- as.factor(freq.long$age)

#means
wfe.means <- summarySE(data = freq.long,
                       measurevar = "wfe",
                       groupvars = c("age", "recog"),
                       na.rm = FALSE,
                       conf.interval = 0.95,
                       .drop = TRUE)

kable(wfe.means, digits = 2, caption = "Speeded Naming Mean WFE zRTs")
                                                 
wfe.means$age <- factor(wfe.means$age, levels = c("YA", "OA"))  
wfe.means$recog <- factor(wfe.means$recog, levels = c("Block1", "Block2"))

#plot
ggplot(wfe.means, aes(x = recog,
                      y = wfe,
                      fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("dodgerblue4", "dodgerblue3")) +
  labs(x = "Block Type",
       y = "Word Frequency Effect from Raw RTs", 
       title = "Word Frequency Effect from Raw RTs by Age", 
       fill = "Block Type") +
  geom_errorbar(aes (ymin = wfe - se, ymax = wfe + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) +
  theme(title = element_text(face = "bold", size = rel(1.75)),
        axis.text = element_text(face = "bold", size = rel(1.75)),
        axis.title = element_text(face = "bold", size = rel(1.75)),
        legend.text = element_text(face = "bold", size = rel(1.75)),
        strip.text = element_text(face = "bold", size = rel(1.75)),
        legend.position = "right") + 
          coord_cartesian(ylim = c(-20, 80)) 

ggsave("~/Desktop/E2_WFE_noblock3_raw.pdf", width = 13, height = 10, units = "in", dpi = 150)

#anova
#pander it to make it pretty
pander(anova(aov(wfe ~ age*recog, data = freq.long)))

#t tests
freq.wide <- spread(freq.long, recog, wfe)
freq.wide.ya <- subset(freq.wide, age == "YA")
freq.wide.oa <- subset(freq.wide, age == "OA")
pander(t.test(freq.wide.ya$Block1, freq.wide.ya$Block2))
pander(t.test(freq.wide.oa$Block1, freq.wide.oa$Block2))
```

### Recognition
#### Study X Frequency
```{r}
recog.rt <- subset(data2, recog.ACC == "1")
recog.rt <- subset(recog.rt, Subject != "317")

recog <- recog.rt %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = mean(rt.trim2.r[which(study_freq == "studied_hf")], na.rm = TRUE),
    studied_lf = mean(rt.trim2.r[which(study_freq == "studied_lf")], na.rm = TRUE),
    notstudied_hf = mean(rt.trim2.r[which(study_freq == "notstudied_hf")], na.rm = TRUE),
    notstudied_lf = mean(rt.trim2.r[which(study_freq == "notstudied_lf")], na.rm = TRUE),
    age = unique(age))
  
#data to long format and gather by condition
recog.long <- gather(recog, type, RT, studied_hf:notstudied_lf) 

recog.means <- summarySE(data = recog.long, 
                            measurevar = "RT",
                            groupvars = c("type", "age"))

kable(recog.means, digits = 2, caption = "Recognition Mean Raw, Trimmed RTs")

##delete this stuff 
recog.means$type <- factor(recog.means$type, levels=c("notstudied_hf", "notstudied_lf", "studied_hf", "studied_lf"))

ggplot(recog.means, aes(x = type,
                           y = RT)) + 
  geom_bar(position = "dodge",
           stat = "identity") +
  labs(y = "Raw, Trimmed RT", 
       title = "Recognition Raw, Trimmed RT") +
  geom_errorbar(aes (ymin = RT - se, ymax = RT + se),
                position = position_dodge(.9), width = .1) +
  scale_fill_manual(values = c("black")) +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14, face = "bold")) +
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4)

#anova
recog.long$study <- with(recog.long, ifelse(type %in% c("notstudied_hf", "notstudied_lf"), "notstudied", "studied"))
recog.long$freq <- with(recog.long, ifelse(type %in% c("notstudied_hf", "studied_hf"), "HF", "LF"))

ezanova <- ezANOVA(data = recog.long, 
                   dv = RT,
                   wid = Subject,
                   within = c("study", "freq"),
                   between = age)

#pander it to make it pretty
pander(ezanova$ANOVA, caption = "Implict Encoding Raw, Trimmed RTs")
```

## Accuracy
### Speeded Naming
#### Study X Frequency
```{r}
#data1
accuracy1 <- data %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = sum(accuracy[which(study_freq == "studied_hf")]/10, na.rm = TRUE),
    studied_lf = sum(accuracy[which(study_freq == "studied_lf")]/10, na.rm = TRUE),
    notstudied_hf = sum(accuracy[which(study_freq == "notstudied_hf")]/10, na.rm = TRUE),
    notstudied_lf = sum(accuracy[which(study_freq == "notstudied_lf")]/10, na.rm = TRUE),
    age = unique(age),
    recog = "no recog")

#data to long format and gather by condition
accuracy1.long <- gather(accuracy1, type, acc, studied_hf:notstudied_lf) 

#data2
accuracy2 <- data2 %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = sum(accuracy[which(study_freq == "studied_hf")]/10, na.rm = TRUE),
    studied_lf = sum(accuracy[which(study_freq == "studied_lf")]/10, na.rm = TRUE),
    notstudied_hf = sum(accuracy[which(study_freq == "notstudied_hf")]/10, na.rm = TRUE),
    notstudied_lf = sum(accuracy[which(study_freq == "notstudied_lf")]/10, na.rm = TRUE),
    age = unique(age),
    recog = "w/ recog")

#data to long format and gather by condition
accuracy2.long <- gather(accuracy2, type, acc, studied_hf:notstudied_lf) 

#data3
accuracy3 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = sum(accuracy[which(study_freq == "studied_hf")]/10, na.rm = TRUE),
    studied_lf = sum(accuracy[which(study_freq == "studied_lf")]/10, na.rm = TRUE),
    notstudied_hf = sum(accuracy[which(study_freq == "notstudied_hf")]/10, na.rm = TRUE),
    notstudied_lf = sum(accuracy[which(study_freq == "notstudied_lf")]/10, na.rm = TRUE),
    age = unique(age),
    recog = "no recog2")

#data to long format and gather by condition
accuracy3.long <- gather(accuracy3, type, acc, studied_hf:notstudied_lf)

accuracy.combined <- full_join(accuracy1.long, accuracy2.long)
accuracy.combined <- full_join(accuracy.combined, accuracy3.long)

#add in separate freq and study columns
accuracy.combined$freq <- with(accuracy.combined, ifelse(type == "studied_hf", "HF",
                                    ifelse(type == "studied_lf", "LF",
                                           ifelse(type == "notstudied_hf", "HF",
                                                  ifelse(type == "notstudied_lf", "LF", NA)))))

accuracy.combined$studied <- with(accuracy.combined, ifelse(type == "studied_hf", "studied",
                                            ifelse(type == "studied_lf", "studied",
                                                   ifelse(type == "notstudied_hf", "notstudied",
                                                          ifelse(type == "notstudied_lf", "notstudied", NA)))))

#means
combined.means <- summarySE(data = accuracy.combined,
                        measurevar = "acc",
                        groupvars = c("recog", "type", "age"),
                        na.rm = FALSE,
                        conf.interval = 0.95,
                        .drop = TRUE)

kable(combined.means, digits = 2, caption = "Speeded Naming Mean Accuracy")

#plot
ggplot(combined.means, aes(x = type,
                           y = acc,
                           fill = factor(recog))) +
geom_bar(position = "dodge",
         stat = "identity",
         color = "black") +
  scale_fill_manual(values = c("black", "snow3", "white")) +
  labs(y = "Accuracy (%)", 
       title = "Speeded Naming w/ and w/o Recog Accuracy", 
       fill = "W or W/o Recog") +
  geom_errorbar(aes (ymin = acc - se, ymax = acc + se),
                position = position_dodge(.9), width = .1) +
  theme_bw() +
          coord_cartesian(ylim = c(.8, 1)) +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4) + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) 

#anova
pander(anova(aov(acc ~ age*studied*freq*recog, data = accuracy.combined)))
```

### Recognition
#### Study X Frequency
```{r}
recognition <- data2 %>%
  group_by(Subject) %>%
  summarize(
    studied_hf = sum(recog.ACC[which(study_freq == "studied_hf")]/10, na.rm = TRUE),
    studied_lf = sum(recog.ACC[which(study_freq == "studied_lf")]/10, na.rm = TRUE),
    notstudied_hf = sum(recog.ACC[which(study_freq == "notstudied_hf")]/10, na.rm = TRUE),
    notstudied_lf = sum(recog.ACC[which(study_freq == "notstudied_lf")]/10, na.rm = TRUE),
    age = unique(age))

recog.long <- gather(recognition, type, accuracy, studied_hf:notstudied_lf) 

recog <- summarySE(data = recog.long,
                    measurevar = "accuracy",
                    groupvars = c("type", "age"),
                    na.rm = TRUE,
                    conf.interval = 0.95,
                    .drop = TRUE)

kable(recog, digits = 2, caption = "Recognition Accuracy")

recog$type <- factor(recog$type, levels=c("notstudied_hf", "notstudied_lf", "studied_hf", "studied_lf"))

ggplot(recog, aes(x = type,
                  y = accuracy)) + 
  geom_bar(position = "dodge",
           stat = "identity",
           color = "black") +
  labs(x = "Trial Type", 
       y = "Accuracy (%)", 
       title = "Recognition Accuracy") +
  geom_errorbar(aes (ymin = accuracy - se, ymax = accuracy + se),
                position = position_dodge(.9), width = .1) +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14,face = "bold")) +
  scale_fill_manual(values = c("black", "white")) +
  theme_bw() +
          coord_cartesian(ylim = c(.4, 1)) + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  facet_wrap( ~age, scales = "free_x", nrow = 1, ncol = 4)

#anova
recog.long$study <- with(recog.long, ifelse(type %in% c("notstudied_hf", "notstudied_lf"), "notstudied", "studied"))
recog.long$freq <- with(recog.long, ifelse(type %in% c("notstudied_hf", "studied_hf"), "HF", "LF"))

ezanova <- ezANOVA(data = recog.long, 
                   dv = accuracy,
                   wid = Subject,
                   within = c("study", "freq"),
                   between = age)

#pander it to make it pretty
pander(ezanova$ANOVA, caption = "Implict Encoding Recog Accuracy")
```

# Correlations
## Perseverance and MMSE Correlation
```{r}
perseverance <- data %>%
  group_by(Subject) %>%
  summarize(
    norecog = mean(zRT, na.rm = TRUE),
    age = unique(age))

perseverance2 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    norecog2 = mean(zRT, na.rm = TRUE),
    age = unique(age))

perseverance <- full_join(perseverance, perseverance2)

perseverance <- subset(perseverance, age == "OA")

perseverance$perseverence <- perseverance$norecog2 - perseverance$norecog

paperdata <- read.csv("/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/paperwork/paperdata_hs3.csv")
paperdata <- paperdata[complete.cases(paperdata), ]
colnames(paperdata)[1] <- "Subject"

perseverance <- full_join(perseverance, paperdata)

pander(cor.test(perseverance$perseverence, perseverance$MMSE))

ggplot(perseverance, aes(x = MMSE, y = perseverence)) +
    geom_point() +    
    geom_smooth(method = lm,   # Add linear regression line
                se = TRUE) +     # Don't add shaded confidence region
    labs(x = "MMSE", y = "Perseverence Effect", title = "MMSE X Perseverence Effect")
```

## Perseverance and Age Correlation
```{r}
perseverance <- data %>%
  group_by(Subject) %>%
  summarize(
    norecog = mean(zRT, na.rm = TRUE),
    age = unique(age))

perseverance2 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    norecog2 = mean(zRT, na.rm = TRUE),
    age = unique(age))

perseverance <- full_join(perseverance, perseverance2)

perseverance$perseverence <- perseverance$norecog2 - perseverance$norecog

paperdata <- read.csv("/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3/paperwork/paperdata_hs3.csv")
paperdata <- paperdata[complete.cases(paperdata), ]

perseverance <- full_join(perseverance, paperdata)

pander(cor.test(perseverance$perseverence, perseverance$Age))

ggplot(perseverance, aes(x = Age, y = perseverence)) +
    geom_point() +    
    geom_smooth(method = lm,   # Add linear regression line
                se = TRUE) +     # Don't add shaded confidence region
    labs(x = "Age", y = "Perseverence Effect", title = "Age X Perseverence Effect")
```

## Perseverance and Recognition 
```{r}
recognition <- data2 %>%
  group_by(Subject) %>%
  summarize(
    recog = sum(recog.ACC/40, na.rm = TRUE),
    age = unique(age))

perseverance <- data %>%
  group_by(Subject) %>%
  summarize(
    norecog = mean(zRT, na.rm = TRUE),
    age = unique(age))

perseverance2 <- data3 %>%
  group_by(Subject) %>%
  summarize(
    norecog2 = mean(zRT, na.rm = TRUE),
    age = unique(age))

perseverance <- full_join(perseverance, perseverance2)

perseverance$perseverence <- perseverance$norecog2 - perseverance$norecog

perseverance <- full_join(perseverance, recognition)

pander(cor.test(perseverance$perseverence, perseverance$recog))

ggplot(perseverance, aes(x = recog, y = perseverence)) +
    geom_point() +    
    geom_smooth(method = lm,   # Add linear regression line
                se = TRUE) +     # Don't add shaded confidence region
    labs(x = "Recog Accuracy", y = "Perseverence Effect", title = "Recog Accuracy X Perseverence Effect")

perseverance <- full_join(perseverance, paperdata)

pander(summary(lm(perseverence ~ Age*recog, data = perseverance)))
```

# Demographics
```{r}
YAs <- read.csv("/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3_YA_paperdata.csv")
OAs <- read.csv("/Volumes/j.nicosiaSD 1/Cog Psych Lab/ImplicitEncoding/IE3_OA_paperdata.csv")
demos <- full_join(YAs, OAs)
demos$ageGroup <- with(demos, ifelse(Subject < 200, "YA", "OA"))
```

## Age
```{r}
age.means <- summarySE(data = demos,
                           measurevar = "Age",
                           groupvars = c("ageGroup"),
                           na.rm = FALSE,
                           conf.interval = 0.95,
                           .drop = TRUE)

kable(age.means, digits = 2, caption = "Age Group Means")

pander(t.test(YAs$Age, OAs$Age))
```

## Edu
```{r}
edu.means <- summarySE(data = demos,
                           measurevar = "Edu",
                           groupvars = c("ageGroup"),
                           na.rm = FALSE,
                           conf.interval = 0.95,
                           .drop = TRUE)

kable(edu.means, digits = 2, caption = "Edu Group Means")

pander(t.test(YAs$Edu, OAs$Edu))
```

## Shipley
```{r}
vocab.means <- summarySE(data = demos,
                           measurevar = "Shipley",
                           groupvars = c("ageGroup"),
                           na.rm = FALSE,
                           conf.interval = 0.95,
                           .drop = TRUE)

kable(vocab.means, digits = 2, caption = "Shipley Group Means")

pander(t.test(YAs$Shipley, OAs$Shipley))
```

